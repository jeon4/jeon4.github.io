---
title:  "엑셀 생성기 개발"
excerpt: "첫번째 프로그램 엑셀 생성기"

categories:
  - develop
tags:
  - develop

toc: true
toc_sticky: true

date: 2021-04-04
last_modified_at: 2021-04-04

published: true
---
  

안녕하세요.

처음으로 소개할 프로그램은 "엑셀 생성기" 입니다. 

해당 프로그램을 만들게된 계기는 IPS에 차단할 IP를 입력하는 과정에서 다수의 IP를 입력할 시 생기는 문제점 때문입니다.

블랙 IP를 단일 차단 할때는 IPS 차단 항목에 들어가 차단 IP를 입력 후 버튼을 눌러주면 간단하게 차단 적용이 되었습니다. 

하지만, 해당 IPS에서 한번에 대량의 IP를 차단 등록할 때는 배치파일(.xls)을 작성하여 사용해야 했습니다.

상기 방법은 두가지 단점이 존재 했습니다.

1. -> 매번 배치파일 양식으로 만들어 주기 번거로움
2. -> DRM 솔루션에 의한 문서 잠금

따라서 해당 업무의 개선점을 고민하다 파이썬으로 배치 파일을 자동으로 만들어주는 프로그램을 만들기로 했습니다.

대략 적인 순서도는 다음과 같습니다.

![엑셀생성기_순서도](/assets/images/엑셀생성기_순서도.jpg)

핵심으로 생각한 점은 몇가지 있었는데 다음과 같았습니다.
1. 패키징된 실행파일(.exe)로 배포하여 사용 편리성 증가.
2. 간단하면서 직관적인 UI구성

위처럼 몇가지 특이점을 생각하며 기능에 대한 구상이 어느정도 끝났으면 간단하게 슈도코드 등으로 밑그림을 그려보았습니다.

&#35; 파이썬 입출력을 통한 메모장의 IP를 읽어와서 리스트 등으로 다루기 쉽게 정제.  
open('블랙IP.txt', 'r') as f:  
  list_file = f.readlines()  // 간단하게 한줄씩 받아오면 될 것같다.  

&#35; 정제한 IP리스트를 openpyxl 모듈을 이용하여 배치파일(.xls) 양식에 맞게 구성.  
        wb=Workbook() // Workbook 생성  
        ws1=wb.active // WorkSheet 생성  

ws1['A1']="블랙IP 넣는 부분"  
        cell = ws1['A1']  
        cell.fill = openpyxl.styles.fills.PatternFill(patternType='solid',fgColor=openpyxl.styles.colors.Color(rgb='f89b00'))  
        // 각 IPS가 요구하는 배치파일 양식에 맞게 각 행,렬을 변수로 지정한뒤 입력되게 지정.  
        // 이왕 넣는 것 글씨체, 색상, 정렬 등 다 지정하기로 했다.  

이렇게 구성하면 기능적인 내용은 끝! 엄청 간단하다.

당연히 그런것이 IP를 받아와서 엑셀로 뿌려주면 되는 기능이라..

사용자가 버튼을 클릭하면 그 값을 조건문으로 지정하여 각 장비에 맞게 엑셀 양식이 바뀌게 설정 해주면 될 것 같다.

PyQt5 모듈을 이용하여 간단한 GUI를 구성해준다!

&#35; 복잡한 UI를 구성할 것이 아니기에 크기와 위치 등 간단하게 지정해준 뒤 버튼이 눌렸을때의 이벤트 효과만 잘 지정해주면 될 것 같다.  

class Ui_MainWindow(object):  
    def setupUi(self, MainWindow):  
        MainWindow.setObjectName("MainWindow")  
        MainWindow.resize(285, 160)  
        self.centralwidget = QtWidgets.QWidget(MainWindow)  
        ...  
        self.첫번째 장비.clicked.connect(self.눌렸을때 실행할 함수)  
        self.두번째 장비.clicked.connect(self.눌렸을때 실행할 함수)  

![엑셀생성기_사진](/assets/images/엑셀생성기_사진.jpg)

이런 식으로 간단하게 구성했다!. 아이콘, 상단 로고 등은 사소하지만 완성됐을때 퀄리티를 높게 만들어주는 것 같다ㅋㅋ..  

이제 재밌는 코딩을 하며 디테일을 살려주자  
&#42; try-catch 등으로 예외처리 핸들링 해주기  
&#42; 버퍼 오버플로우 등 사용자 환경에 악영향은 없는지 등  
&#42; 사용법 등 메뉴얼도 같이 작성해주면 나중에 편하다!  

이렇게 코딩작업이 끝나면 배포 전 몇 인원 들에게 선 배포하여 문제점 개선안 등 피드백을 받아준다.

ex) 엑셀 제목에 오늘 날짜가 있으면 좋겠다, 화면이 너무 크다 등 개선안에 맞게 코드 수정  

이렇게 완성된 엑셀생성기를 해당 업무를 하는 팀원들에게 파일과 사용법을 공유하여 작업을 끝냅니다.

메일로 사용법과 함게 공유해주면 간편~ 컴플라이언스에 올려도 된다!

후기)  
엄청 간단한 프로그램이지만 효과는 굉장했습니다.

기존 5분넘게 소요되던 대량 차단 소요시간이 약 15초 정도로 단축되었습니다.

앞으로 이것저것 많이 개선하여 업무 자동화의 도움이 많이 되어야겠습니다.

감사합니다.